<!DOCTYPE html SYSTEM "about:legacy-compat">
<html lang="en-US" data-preset="contrast" data-primary-color="#307FFF"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="UTF-8"><meta name="robots" content="noindex"><meta name="built-on" content="2025-10-13T09:45:45.713210522"><title>Query options | apollo-kotlin-normalized-cache</title><script type="application/json" id="virtual-toc-data">[{"id":"fetchpolicy","level":0,"title":"fetchPolicy","anchor":"#fetchpolicy"},{"id":"servererrorsascachemisses","level":0,"title":"serverErrorsAsCacheMisses","anchor":"#servererrorsascachemisses"},{"id":"throwoncachemiss","level":0,"title":"throwOnCacheMiss","anchor":"#throwoncachemiss"},{"id":"maxstale","level":0,"title":"maxStale","anchor":"#maxstale"}]</script><script type="application/json" id="topic-shortcuts"></script><link href="https://resources.jetbrains.com/writerside/apidoc/6.10.0-b575/app.css" rel="stylesheet"><link href="static/custom.css" rel="stylesheet"><link rel="icon" type="image/png" sizes="16x16" href="images/favicon-96x96.png"><link rel="icon" type="image/png" sizes="32x32" href="images/favicon-192x192.png"><meta name="image" content=""><!-- Open Graph --><meta property="og:title" content="Query options | apollo-kotlin-normalized-cache"><meta property="og:description" content=""><meta property="og:image" content=""><meta property="og:site_name" content="apollo-kotlin-normalized-cache Help"><meta property="og:type" content="website"><meta property="og:locale" content="en_US"><meta property="og:url" content="writerside-documentation/options.html"><!-- End Open Graph --><!-- Twitter Card --><meta name="twitter:card" content="summary_large_image"><meta name="twitter:site" content=""><meta name="twitter:title" content="Query options | apollo-kotlin-normalized-cache"><meta name="twitter:description" content=""><meta name="twitter:creator" content=""><meta name="twitter:image:src" content=""><!-- End Twitter Card --><!-- Schema.org WebPage --><script type="application/ld+json">{
    "@context": "http://schema.org",
    "@type": "WebPage",
    "@id": "writerside-documentation/options.html#webpage",
    "url": "writerside-documentation/options.html",
    "name": "Query options | apollo-kotlin-normalized-cache",
    "description": "",
    "image": "",
    "inLanguage":"en-US"
}</script><!-- End Schema.org --><!-- Schema.org WebSite --><script type="application/ld+json">{
    "@type": "WebSite",
    "@id": "writerside-documentation/#website",
    "url": "writerside-documentation/",
    "name": "apollo-kotlin-normalized-cache Help"
}</script><!-- End Schema.org --></head><body data-id="options" data-main-title="Query options" data-article-props="{&quot;seeAlsoStyle&quot;:&quot;links&quot;}" data-template="article" data-breadcrumbs="" data-edit-url="https://github.com/apollographql/apollo-kotlin-normalized-cache/edit/main/Writerside/topics/options.md"><div class="wrapper"><main class="panel _main"><header class="panel__header"><div class="container"><h3>apollo-kotlin-normalized-cache  Help</h3><div class="panel-trigger"></div></div></header><section class="panel__content"><div class="container"><article class="article" data-shortcut-switcher="inactive"><h1 data-toc="options" id="options.md">Query options</h1><p id="f1nqyl_3">When you execute a query, options control how the query is executed. <code class="code" id="f1nqyl_8">ApolloClient</code> returns an <code class="code" id="f1nqyl_9">ApolloResponse</code> that satisfies the options or an exceptional response otherwise (<code class="code" id="f1nqyl_10">response.exception</code> is not null).</p><section class="chapter"><h2 id="fetchpolicy" data-toc="fetchpolicy"><code class="code" id="f1nqyl_17">fetchPolicy</code></h2><p id="f1nqyl_12">Fetch policy controls how and if the cache is used. The default is <code class="code" id="f1nqyl_18">CacheFirst</code>.</p><section class="chapter"><h3 id="cachefirst" data-toc="cachefirst"><code class="code" id="f1nqyl_21">CacheFirst</code></h3><p id="f1nqyl_20">A response is fetched from the cache first. If no valid response cannot be found, the network is queried.</p></section><section class="chapter"><h3 id="cacheonly" data-toc="cacheonly"><code class="code" id="f1nqyl_24">CacheOnly</code></h3><p id="f1nqyl_23">The response is fetched from the cache. If no valid response cannot be found, <code class="code" id="f1nqyl_25">response.exception</code> is set.</p></section><section class="chapter"><h3 id="networkonly" data-toc="networkonly"><code class="code" id="f1nqyl_28">NetworkOnly</code></h3><p id="f1nqyl_27">The response is fetched from the network. If no valid response cannot be found, <code class="code" id="f1nqyl_29">response.exception</code> is set.</p></section><section class="chapter"><h3 id="networkfirst" data-toc="networkfirst"><code class="code" id="f1nqyl_32">NetworkFirst</code></h3><p id="f1nqyl_31">A response is fetched from the network first. If no valid response cannot be found, the cache is queried.</p></section></section><section class="chapter"><h2 id="servererrorsascachemisses" data-toc="servererrorsascachemisses"><code class="code" id="f1nqyl_35">serverErrorsAsCacheMisses</code></h2><p id="f1nqyl_34">Sets whether GraphQL errors in the cache should be treated as cache misses. When true (the default), if any field is an Error in the cache, the returned response will have a null data and a non-null exception of type <code class="code" id="f1nqyl_36">ApolloGraphQLException</code>.</p></section><section class="chapter"><h2 id="throwoncachemiss" data-toc="throwoncachemiss"><code class="code" id="f1nqyl_40">throwOnCacheMiss</code></h2><p id="f1nqyl_38">Sets whether missing fields from the cache should result in an exception. When true (the default), if any field is missing in the cache, the returned response will have a null data and a non-null exception of type <code class="code" id="f1nqyl_41">CacheMissException</code>.</p><p id="f1nqyl_39">Set this to false to allow partial responses from the cache, where <span class="emphasis" id="f1nqyl_42">some</span> or <span class="emphasis" id="f1nqyl_43">all</span> of the fields may be missing.</p></section><section class="chapter"><h2 id="maxstale" data-toc="maxstale"><code class="code" id="f1nqyl_48">maxStale</code></h2><p id="f1nqyl_45">If stale fields are acceptable up to a certain value, you can set a maximum staleness duration. This duration is the maximum time that a stale field will be resolved without resulting in a cache miss. To set this duration, call <a href="https://apollographql.github.io/apollo-kotlin-normalized-cache/kdoc/normalized-cache/com.apollographql.cache.normalized/max-stale.html?query=fun%20%3CT%3E%20MutableExecutionOptions%3CT%3E.maxStale(maxStale:%20Duration):%20T" id="f1nqyl_49" data-external="true" rel="noopener noreferrer"><code class="code" id="f1nqyl_50">.maxStale(Duration)</code></a> either globally on your client, or per operation:</p><div class="code-block" data-lang="kotlin">
val response = client.query(MyQuery())
    .fetchPolicy(FetchPolicy.CacheOnly)
    .maxStale(1.hours)
    .execute()
</div><section class="chapter"><h3 id="isstale" data-toc="isstale"><code class="code" id="f1nqyl_54">isStale</code></h3><p id="f1nqyl_52">With <code class="code" id="f1nqyl_55">maxStale</code>, it is possible to get data from the cache even if it is stale. To know if the response contains stale fields, you can check <a href="https://apollographql.github.io/apollo-kotlin-normalized-cache/kdoc/normalized-cache/com.apollographql.cache.normalized/-cache-info/is-stale.html" id="f1nqyl_56" data-external="true" rel="noopener noreferrer"><code class="code" id="f1nqyl_57">CacheInfo.isStale</code></a>:</p><div class="code-block" data-lang="kotlin">
if (response.cacheInfo?.isStale == true) {
  // The response contains at least one stale field
}
</div></section></section><div class="last-modified">Last modified: 06 August 2025</div><div data-feedback-placeholder="true"></div><div class="navigation-links _bottom"><a href="expiration.html" class="navigation-links__prev">Expiration</a><a href="pagination-home.html" class="navigation-links__next">Pagination</a></div></article><div id="disqus_thread"></div></div></section></main></div><script src="https://resources.jetbrains.com/writerside/apidoc/6.10.0-b575/app.js"></script></body></html>